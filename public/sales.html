<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sales - Laxmira</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/styles.css">
   <!-- Local vendor files -->
   <script src="/vendor/iconify-icon.min.js"></script>
   <script src="/vendor/chart.umd.js"></script>

   <!-- Your scripts -->
   <script src="/js/api.js" defer></script>
   <script src="/js/sales.js" defer></script>
   <script src="/js/layout.js" defer></script>
   <script>
    document.addEventListener("DOMContentLoaded", async () => {
      await loadLayout();
      initSales();
    });
  </script>

</head>
<body class="bg-gray-100 min-h-screen">

<div id="header"></div>

<div class="w-full p-6 lg:p-8 space-y-8">

  <!-- âž• Add Sale (Multi-Product) -->
  <div class="bg-white shadow-2xl rounded-3xl p-8 border border-gray-100">
    <h3 class="text-3xl font-bold mb-8 flex items-center gap-4 text-gray-800 pb-4 border-b border-gray-200">
      <div class="bg-gradient-to-br from-blue-500 to-cyan-500 p-4 rounded-2xl text-white shadow-xl">
        <iconify-icon icon="flat-color-icons:sales-performance" class="text-4xl"></iconify-icon>
      </div>
      <span>New Sales Order</span>
    </h3>

    <!-- Customer Section -->
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 mb-8 bg-gray-50 p-6 rounded-2xl border border-gray-200">
      <div class="lg:col-span-12 flex items-center gap-2 text-gray-600 mb-2 font-semibold uppercase text-xs tracking-wider">
        <iconify-icon icon="mdi:account-details" class="text-lg"></iconify-icon> Customer Details
      </div>
      
      <div class="lg:col-span-2">
        <input id="saleDate" type="date" class="w-full border-2 border-gray-200 rounded-xl p-3 focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all font-medium text-gray-700">
      </div>
      
      <div class="lg:col-span-3">
        <input id="customerPhone" class="w-full border-2 border-gray-200 rounded-xl p-3 focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all" placeholder="ðŸ“± Mobile Number *">
      </div>
      
      <div class="lg:col-span-3">
        <input id="customerName" class="w-full border-2 border-gray-200 rounded-xl p-3 focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all" placeholder="ðŸ‘¤ Customer Name *">
      </div>

      <div class="lg:col-span-4">
        <input id="customerAddress" class="w-full border-2 border-gray-200 rounded-xl p-3 focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all" placeholder="ðŸ“ Address (Optional)">
      </div>
    </div>

    <!-- Product Rows Container -->
    <div class="border-2 border-gray-100 rounded-2xl p-6 mb-8 bg-white shadow-inner">
      <div class="flex flex-col md:flex-row items-center justify-between mb-6 gap-4">
        <h4 class="font-bold text-gray-700 flex items-center gap-2">
          <iconify-icon icon="mdi:cart-outline" class="text-xl"></iconify-icon> 
          Items in Cart
        </h4>
        <button type="button" onclick="addProductRow()" 
                class="bg-emerald-100 hover:bg-emerald-200 text-emerald-700 font-bold py-2 px-4 rounded-xl shadow-sm hover:shadow-md transition-all flex items-center gap-2 text-sm">
          <iconify-icon icon="mdi:plus-circle" class="text-lg"></iconify-icon>
          Add Another Product
        </button>
      </div>

      <!-- Header Row -->
      <div class="hidden md:grid grid-cols-12 gap-4 text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 px-2">
        <div class="col-span-5">Product Details</div>
        <div class="col-span-2 text-center">Qty</div>
        <div class="col-span-2 text-center">MRP</div>
        <div class="col-span-1 text-center">Disc %</div>
        <div class="col-span-2 text-right">Total</div>
      </div>

      <!-- Dynamic Product Rows -->
      <div id="productRows" class="flex flex-col gap-3"></div>
    </div>

    <!-- Footer: Totals & Submit -->
    <div class="bg-gray-900 text-white rounded-2xl p-6 shadow-xl flex flex-col lg:flex-row items-center justify-between gap-6">
      <div class="text-gray-400 text-sm flex items-center gap-2">
        <iconify-icon icon="mdi:information-outline"></iconify-icon>
        Totals are calculated automatically. Stock will reduce upon saving.
      </div>
      
      <div class="flex items-center gap-6 w-full lg:w-auto">
        <div class="text-right">
          <div class="text-gray-400 text-xs uppercase font-bold tracking-wider mb-1">Grand Total</div>
          <div class="text-3xl font-bold text-emerald-400 font-mono">â‚¹<span id="grandTotalDisplay">0.00</span></div>
          <input id="grandTotal" type="hidden">
        </div>

        <button onclick="submitOrder()" 
                class="flex-1 lg:flex-none bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white font-bold py-4 px-8 rounded-xl shadow-lg transform hover:-translate-y-1 transition-all flex items-center justify-center gap-2 text-lg">
          <iconify-icon icon="mdi:check-circle" class="text-2xl"></iconify-icon>
          Complete Sale
        </button>
      </div>
    </div>
  </div>

  <!-- ðŸ” Recent Sales Section -->
  <div class="bg-white shadow-xl rounded-3xl p-8 border border-gray-100">
    <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-6">
      <h3 class="text-2xl font-bold flex items-center gap-3 text-gray-800">
        <iconify-icon icon="mdi:history" class="text-3xl text-orange-500"></iconify-icon>
        Recent Transactions
      </h3>
      
      <!-- Filters -->
      <div class="flex flex-wrap gap-3 w-full md:w-auto">
        <input id="fromDate" type="date" class="border border-gray-300 rounded-lg p-2 text-sm">
        <input id="toDate" type="date" class="border border-gray-300 rounded-lg p-2 text-sm">
        <input id="productFilter" class="border border-gray-300 rounded-lg p-2 text-sm flex-1" placeholder="Search product...">
        <button onclick="loadSales()" class="bg-gray-800 text-white px-4 py-2 rounded-lg text-sm hover:bg-black transition">Filter</button>
      </div>
    </div>

    <div class="overflow-x-auto rounded-xl border border-gray-200">
      <table class="w-full border-collapse">
        <thead class="bg-gray-50">
          <tr>
            <th class="p-4 text-left text-xs font-bold text-gray-500 uppercase">Date</th>
            <th class="p-4 text-center text-xs font-bold text-gray-500 uppercase">Image</th>
            <th class="p-4 text-left text-xs font-bold text-gray-500 uppercase">Product</th>
            <th class="p-4 text-center text-xs font-bold text-gray-500 uppercase">Stock Flow</th>
            <th class="p-4 text-right text-xs font-bold text-gray-500 uppercase">Amount</th>
            <th class="p-4 text-right text-xs font-bold text-gray-500 uppercase">Profit</th>
          </tr>
        </thead>
        <tbody id="tbody" class="divide-y divide-gray-100"></tbody>
      </table>
    </div>
  </div>

</div>

<div id="footer"></div>


</body>
</html>
