<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Expenses - Laxmira</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles.css">
    <!-- Local vendor files -->
    <script src="/vendor/iconify-icon.min.js"></script>
    <script src="/vendor/chart.umd.js"></script>

    <!-- Your scripts -->
    <script src="/js/api.js" defer></script>
    <script src="/js/expenses.js" defer></script>
    <script src="/js/layout.js" defer></script>
    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        await loadLayout();
        initExpenses();
      });
    </script>

  </head>
  <body class="bg-gray-100 min-h-screen">

    <!-- Common Header -->
    <div id="header"></div>

    <div class="w-full p-6 lg:p-8 space-y-8">

      <!-- Add/Edit Form -->
      <div class="bg-white shadow-xl rounded-2xl p-8">
        <h3
          class="text-2xl font-bold mb-6 flex items-center gap-3 text-gray-800">
          <iconify-icon icon="streamline-ultimate-color:money-bag-dollar"
            class="text-3xl"></iconify-icon>
          Add/Edit Expense
        </h3>

        <div class="grid grid-cols-1 md:grid-cols-12 gap-4 items-end">
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2">Date
              *</label>
            <input
              class="w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              id="date" type="date" />
          </div>

          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2">Category
              *</label>
            <select
              class="w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              id="category">
              <option value>Select Category</option>
              <option value="Rent">ğŸ  Rent</option>
              <option value="Electricity">âš¡ Electricity</option>
              <option value="Water">ğŸ’§ Water</option>
              <option value="Staff Salary">ğŸ‘¥ Staff Salary</option>
              <option value="Maintenance">ğŸ”§ Maintenance</option>
              <option value="Transport">ğŸšš Transport</option>
              <option value="Marketing">ğŸ“¢ Marketing</option>
              <option value="Misc">ğŸ“¦ Misc / Daily</option>
            </select>
          </div>

          <div class="md:col-span-3">
            <label class="block text-sm font-medium text-gray-700 mb-2">Amount
              (â‚¹) *</label>
            <input
              class="w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-right font-mono text-xl"
              id="amount" type="number" min="0" step="0.01"
              placeholder="0.00" />
          </div>

          <div class="md:col-span-3">
            <label class="block text-sm font-medium text-gray-700 mb-2">Note
              (Optional)</label>
            <input
              class="w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
              id="note" placeholder="Description..." />
          </div>

          <div class="md:col-span-2 space-y-2">
            <button id="saveBtn" onclick="saveExpense()"
              class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-4 px-6 rounded-xl shadow-lg hover:shadow-xl hover:from-blue-600 hover:to-blue-700 transform hover:-translate-y-0.5 transition-all duration-200 flex items-center justify-center gap-2 text-lg">
              <iconify-icon icon="mdi:plus-circle"></iconify-icon>
              Add Expense
            </button>

            <button id="cancelBtn" onclick="cancelEdit()"
              class="w-full bg-gradient-to-r from-red-500 to-red-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl hover:from-red-600 hover:to-red-700 transform hover:-translate-y-0.5 transition-all duration-200 hidden">
              Cancel Edit
            </button>
          </div>
        </div>
      </div>

      <!-- Filters -->
      <div class="bg-white shadow-xl rounded-2xl p-8">
        <h3
          class="text-2xl font-bold mb-6 flex items-center gap-3 text-gray-800">
          <iconify-icon icon="mdi:filter" class="text-3xl"></iconify-icon>
          Filters
        </h3>

        <div class="grid grid-cols-1 md:grid-cols-12 gap-4 items-end">
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2">From
              Date</label>
            <input id="fromDate" type="date"
              class="w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500" />
          </div>

          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2">To
              Date</label>
            <input id="toDate" type="date"
              class="w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500" />
          </div>

          <div class="md:col-span-3">
            <label
              class="block text-sm font-medium text-gray-700 mb-2">Category</label>
            <select id="filterCategory"
              class="w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-indigo-500">
              <option value>All Categories</option>
              <option value="Rent">ğŸ  Rent</option>
              <option value="Electricity">âš¡ Electricity</option>
              <option value="Water">ğŸ’§ Water</option>
              <option value="Staff Salary">ğŸ‘¥ Staff Salary</option>
              <option value="Maintenance">ğŸ”§ Maintenance</option>
              <option value="Transport">ğŸšš Transport</option>
              <option value="Marketing">ğŸ“¢ Marketing</option>
              <option value="Misc">ğŸ“¦ Misc</option>
            </select>
          </div>

          <div class="md:col-span-5 grid grid-cols-1 sm:grid-cols-3 gap-3">
            <button onclick="loadExpenses()"
              class="bg-gradient-to-r from-emerald-500 to-emerald-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl hover:from-emerald-600 hover:to-emerald-700 transition-all duration-200">
              <iconify-icon icon="mdi:filter-check"
                class="inline mr-2"></iconify-icon>
              Apply Filters
            </button>

            <button onclick="setPreviousMonth()"
              class="bg-gradient-to-r from-indigo-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl hover:from-indigo-600 hover:to-indigo-700 transition-all duration-200">
              <iconify-icon icon="mdi:calendar-month-outline"
                class="inline mr-2"></iconify-icon>
              Prev Month
            </button>

            <button onclick="clearFilters()"
              class="bg-gradient-to-r from-gray-500 to-gray-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl hover:from-gray-600 hover:to-gray-700 transition-all duration-200">
              <iconify-icon icon="mdi:close-circle-outline"
                class="inline mr-2"></iconify-icon>
              Clear All
            </button>
          </div>
        </div>
      </div>

      <!-- Expenses Table -->
      <div class="bg-white shadow-xl rounded-2xl p-8">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold flex items-center gap-3 text-gray-800">
            <iconify-icon icon="mdi:format-list-checks"
              class="text-3xl"></iconify-icon>
            Expenses List
          </h3>
          <div
            class="text-3xl font-bold text-emerald-600 bg-emerald-100 px-6 py-3 rounded-2xl shadow-lg"
            id="total">
            Total: â‚¹0
          </div>
        </div>

        <div class="overflow-x-auto">
          <table
            class="w-full border-collapse bg-white rounded-2xl overflow-hidden shadow-inner">
            <thead class="bg-gradient-to-r from-gray-100 to-gray-200">
              <tr>
                <th
                  class="border-b border-gray-200 p-4 text-left font-bold text-gray-700 text-sm uppercase tracking-wide">S.No.</th>
                <th
                  class="border-b border-gray-200 p-4 text-left font-bold text-gray-700 text-sm uppercase tracking-wide">Date</th>
                <th
                  class="border-b border-gray-200 p-4 text-left font-bold text-gray-700 text-sm uppercase tracking-wide">Category</th>
                <th
                  class="border-b border-gray-200 p-4 text-right font-bold text-gray-700 text-sm uppercase tracking-wide">Amount</th>
                <th
                  class="border-b border-gray-200 p-4 text-left font-bold text-gray-700 text-sm uppercase tracking-wide">Note</th>
                <th
                  class="border-b border-gray-200 p-4 text-center font-bold text-gray-700 text-sm uppercase tracking-wide">Actions</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100" id="tbody">
              <tr>
                <td colspan="6" class="text-center py-12 text-gray-400 text-xl">
                  <iconify-icon icon="mdi:loading"
                    class="text-4xl mx-auto mb-4 inline-block animate-spin"></iconify-icon>
                  Loading expenses...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Common Footer -->
    <div id="footer"></div>

  </body>
</html>
